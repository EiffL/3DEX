<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>3DEX: /Users/silver/Dropbox/3DEX/src/f90/mod/f3dex_utests.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">3DEX&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">Three-dimensional Fourier-Bessel decomposition</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">/Users/silver/Dropbox/3DEX/src/f90/mod/f3dex_utests.f90</div>  </div>
</div>
<div class="contents">
<a href="f3dex__utests_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacef3dex__utests.html">00001</a> <span class="keyword">MODULE</span> f3dex_utests
<a name="l00002"></a>00002 
<a name="l00003"></a>00003   USE <span class="keywordflow">OMP_LIB</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005   USE <span class="keywordflow">healpix_types</span>
<a name="l00006"></a>00006   USE <span class="keywordflow">healpix_modules</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008   USE <span class="keywordflow">f3dex_transforms</span>
<a name="l00009"></a>00009   USE <span class="keywordflow">f3dex_cosmotools</span>
<a name="l00010"></a>00010   USE <span class="keywordflow">f3dex_stats</span>
<a name="l00011"></a>00011   USE <span class="keywordflow">f3dex_fitstools</span>
<a name="l00012"></a>00012   USE <span class="keywordflow">f3dex_utils</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014   <span class="keyword">IMPLICIT NONE</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">CONTAINS</span>
<a name="l00017"></a>00017     
<a name="l00018"></a>00018   <span class="comment">! ---------------------------------------------------------------------------------------!  </span>
<a name="l00019"></a>00019    
<a name="l00023"></a><a class="code" href="namespacef3dex__utests.html#a1ac11b22f78f0d83a22ab998cc2e1112">00023</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#a1ac11b22f78f0d83a22ab998cc2e1112">utest_inverse</a>(n, prec)
<a name="l00024"></a>00024   
<a name="l00025"></a>00025      <span class="keywordtype">INTEGER(I4B)</span> :: n, prec, i
<a name="l00026"></a>00026      <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(0:n,0:n)</span> :: Aini, A, Ainv, Id
<a name="l00027"></a>00027      <span class="keywordtype">LOGICAL</span> :: res1, res2, res3, res4
<a name="l00028"></a>00028      A = 0.0
<a name="l00029"></a>00029 
<a name="l00030"></a>00030      A(0,0) = 3.0
<a name="l00031"></a>00031      Id(0,0) = 1.0
<a name="l00032"></a>00032      <span class="keyword">DO</span> i=1, n-1
<a name="l00033"></a>00033       A(i,i) = 2.0
<a name="l00034"></a>00034       A(i+1,i-1) = 1.0
<a name="l00035"></a>00035       A(i-1,i+1) = 4.0
<a name="l00036"></a>00036       Id(i,i) = 1.0
<a name="l00037"></a>00037      <span class="keyword">ENDDO</span>
<a name="l00038"></a>00038      A(n,n) = 3.0
<a name="l00039"></a>00039      Id(n,n) = 1.0
<a name="l00040"></a>00040      
<a name="l00041"></a>00041      Aini = A
<a name="l00042"></a>00042      <span class="comment">! Compute inverse</span>
<a name="l00043"></a>00043      CALL <a class="code" href="namespacef3dex__stats.html#a564304481b43b3d55989683f03460410">INVERSE</a>(A(0:n,0:n),n+1,res1)     
<a name="l00044"></a>00044      PRINT*,<span class="stringliteral">&quot;&gt; Compute inverse :&quot;</span>, res1
<a name="l00045"></a>00045      
<a name="l00046"></a>00046      Ainv = A
<a name="l00047"></a>00047      <span class="comment">! Back to A</span>
<a name="l00048"></a>00048      CALL <a class="code" href="namespacef3dex__stats.html#a564304481b43b3d55989683f03460410">INVERSE</a>(A(0:n,0:n),n+1,res2)
<a name="l00049"></a>00049      PRINT*,<span class="stringliteral">&quot;&gt; Back to original :&quot;</span>, res1
<a name="l00050"></a>00050      
<a name="l00051"></a>00051      <span class="comment">! Assert back to original</span>
<a name="l00052"></a>00052      res3 = <a class="code" href="namespacef3dex__utils.html#a234414d8daaf5e3bfd03754331b467ed">assert_DPARR</a>(Aini,A,n+1,prec)
<a name="l00053"></a>00053      PRINT*,<span class="stringliteral">&quot;&gt; Is valid original :&quot;</span>, res3
<a name="l00054"></a>00054      
<a name="l00055"></a>00055      <span class="comment">! Product should be identity</span>
<a name="l00056"></a>00056      A = MATMUL(A,Ainv)
<a name="l00057"></a>00057      res4 = <a class="code" href="namespacef3dex__utils.html#a234414d8daaf5e3bfd03754331b467ed">assert_DPARR</a>(Id,A,n+1,prec)
<a name="l00058"></a>00058      PRINT*,<span class="stringliteral">&quot;&gt; A*Ainv = Id(n) :&quot;</span>, res4
<a name="l00059"></a>00059      
<a name="l00060"></a>00060      <a class="code" href="namespacef3dex__utests.html#a1ac11b22f78f0d83a22ab998cc2e1112">utest_inverse</a> = res1 .AND. res2 .AND. res3 .AND. res4
<a name="l00061"></a>00061      
<a name="l00062"></a>00062      RETURN
<a name="l00063"></a>00063      
<a name="l00064"></a>00064 <span class="keyword">  END FUNCTION utest_inverse</span>
<a name="l00065"></a>00065   
<a name="l00066"></a>00066   <span class="comment">! ---------------------------------------------------------------------------------------!  </span>
<a name="l00067"></a>00067    
<a name="l00071"></a><a class="code" href="namespacef3dex__utests.html#a9afe88e0ae4f7e4e96f5f6c4516310d9">00071</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#a9afe88e0ae4f7e4e96f5f6c4516310d9">utest_trace</a>(ndim, prec)
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     <span class="keywordtype">INTEGER(I4B)</span> :: ndim, i, prec
<a name="l00074"></a>00074     <span class="keywordtype">REAL(DP)</span>,<span class="keywordtype">DIMENSION(0:ndim-1,0:ndim-1)</span> :: M
<a name="l00075"></a>00075     <span class="keywordtype">REAL(DP)</span> :: res
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     M = 0.0
<a name="l00078"></a>00078     <span class="keyword">DO</span> i=0,ndim-1
<a name="l00079"></a>00079        M(i,i) = 1.0
<a name="l00080"></a>00080     <span class="keyword">ENDDO</span>
<a name="l00081"></a>00081     res = <a class="code" href="namespacef3dex__stats.html#aa88d6eefa32a9edc04b3d93af96f5a2e">TRACE</a>(M,0,ndim-1)
<a name="l00082"></a>00082     <a class="code" href="namespacef3dex__utests.html#a9afe88e0ae4f7e4e96f5f6c4516310d9">utest_trace</a> = <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( res, <span class="keywordtype">REAL(ndim,DP)</span>, prec )
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="keyword">  END FUNCTION utest_trace</span>
<a name="l00085"></a>00085   
<a name="l00086"></a>00086   <span class="comment">! ---------------------------------------------------------------------------------------!  </span>
<a name="l00087"></a>00087    
<a name="l00091"></a><a class="code" href="namespacef3dex__utests.html#aaa91fc8ed84fd3255d97e9b51f2cb970">00091</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#aaa91fc8ed84fd3255d97e9b51f2cb970">utest_traceprod</a>(ndim, prec)
<a name="l00092"></a>00092 
<a name="l00093"></a>00093     <span class="keywordtype">INTEGER(I4B)</span> :: ndim, i, prec
<a name="l00094"></a>00094     <span class="keywordtype">REAL(DP)</span>,<span class="keywordtype">DIMENSION(0:ndim-1,0:ndim-1)</span> :: M, Mb
<a name="l00095"></a>00095     <span class="keywordtype">REAL(DP)</span> :: res
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     M = 1.0
<a name="l00098"></a>00098     Mb = 1.0
<a name="l00099"></a>00099     <span class="keyword">DO</span> i=0,ndim-1
<a name="l00100"></a>00100        M(i,i) = 1.0
<a name="l00101"></a>00101     <span class="keyword">ENDDO</span>
<a name="l00102"></a>00102     res = <a class="code" href="namespacef3dex__stats.html#ae106140bb309de7d7779b6b086050bf4">TRACEPROD</a>(M,Mb,0,ndim-1)
<a name="l00103"></a>00103     <a class="code" href="namespacef3dex__utests.html#aaa91fc8ed84fd3255d97e9b51f2cb970">utest_traceprod</a> = <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( res, <span class="keywordtype">REAL(ndim**2,DP)</span>, prec )
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="keyword">  END FUNCTION utest_traceprod</span>
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="comment">! ---------------------------------------------------------------------------------------!  </span>
<a name="l00108"></a>00108    
<a name="l00112"></a><a class="code" href="namespacef3dex__utests.html#a0bd9e3f3f7857cd59dd4787f27053ed2">00112</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#a0bd9e3f3f7857cd59dd4787f27053ed2">utest_legendre</a>(nc, prec)
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="keyword">IMPLICIT NONE</span>
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordtype">INTEGER(I4B)</span> :: i, prec
<a name="l00117"></a>00117     <span class="keywordtype">INTEGER(I4B)</span>, <span class="keywordtype">PARAMETER</span> :: nlmax = 10
<a name="l00118"></a>00118     <span class="keywordtype">INTEGER(I4B)</span> :: nc
<a name="l00119"></a>00119     <span class="keywordtype">LOGICAL</span> :: tempres, res
<a name="l00120"></a>00120     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(0:nc-1)</span> :: x
<a name="l00121"></a>00121     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(0:nc-1,0:nlmax)</span> :: pl_mat
<a name="l00122"></a>00122     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(0:nlmax)</span> :: pl_vec, solution
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keyword">DO</span> i=0, nc-1
<a name="l00125"></a>00125        x(i) = COS(<span class="keywordtype">REAL</span>(i)*2*PI/nc)
<a name="l00126"></a>00126     <span class="keyword">ENDDO</span>
<a name="l00127"></a>00127     
<a name="l00128"></a>00128     res = .TRUE.
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     CALL <a class="code" href="namespacef3dex__stats.html#aa2fb45e013179295e3b876ced9eff015">legendre_mat</a>(x,pl_mat,nc,nlmax)
<a name="l00131"></a>00131     <span class="keyword">DO</span> i=0, nc-1
<a name="l00132"></a>00132        solution(0) = 1.0
<a name="l00133"></a>00133        solution(1) = x(i)
<a name="l00134"></a>00134        solution(2) = 0.5 * ( 3 * x(i)**2 - 1 )
<a name="l00135"></a>00135        solution(3) = 0.5 * ( 5 * x(i)**3 - 3*x(i) )
<a name="l00136"></a>00136        solution(4) = (1.0/8.0) * ( 35.0 * x(i)**4 - 30.0* x(i)**2 + 3.0 )
<a name="l00137"></a>00137        solution(5) = (1.0/8.0) * ( 63.0 * x(i)**5 - 70.0* x(i)**3 + 15.0*x(i) )
<a name="l00138"></a>00138        solution(6) = (1.0/16.0) * ( 231.0 * x(i)**6 - 315.0* x(i)**4 + 105.0*x(i)**2 - 5.0 )
<a name="l00139"></a>00139        solution(7) = (1.0/16.0) * ( 429.0 * x(i)**7 - 693.0* x(i)**5 + 315.0*x(i)**3 - 35.0*x(i) )
<a name="l00140"></a>00140        solution(8) = (1.0/128.0) * ( 6435.0 * x(i)**8 - 12012.0* x(i)**6 + 6930.0*x(i)**4 &amp;
<a name="l00141"></a>00141                    &amp; - 1260.0*x(i)**2 + 35.0 )
<a name="l00142"></a>00142        solution(9) = (1.0/128.0) * ( 12155.0 * x(i)**9 - 25740.0* x(i)**7 + 18018.0*x(i)**5 &amp;
<a name="l00143"></a>00143                    &amp; - 4620.0*x(i)**3 + 315.0*x(i) )
<a name="l00144"></a>00144        solution(10) = (1.0/256.0) * ( 46189.0 * x(i)**10 - 109395.0* x(i)**8 + 90090.0*x(i)**6 &amp;
<a name="l00145"></a>00145                    &amp; - 30030.0*x(i)**4 + 3465.0*x(i)**2 - 63.0 )
<a name="l00146"></a>00146        CALL <a class="code" href="namespacef3dex__stats.html#a1f360b2a41b5a63c3379390a55ef07b2">legendre_vec</a>(x(i),pl_vec(0:nlmax),nlmax)
<a name="l00147"></a>00147        tempres = <a class="code" href="namespacef3dex__utils.html#a234414d8daaf5e3bfd03754331b467ed">assert_DPARR</a>( pl_vec(0:nlmax), pl_mat(i,0:nlmax), nlmax, prec )
<a name="l00148"></a>00148        res = res .AND. tempres
<a name="l00149"></a>00149        tempres = <a class="code" href="namespacef3dex__utils.html#a234414d8daaf5e3bfd03754331b467ed">assert_DPARR</a>( pl_vec(0:nlmax), solution(0:nlmax), nlmax, prec )
<a name="l00150"></a>00150        res = res .AND. tempres
<a name="l00151"></a>00151     <span class="keyword">ENDDO</span>
<a name="l00152"></a>00152     <a class="code" href="namespacef3dex__utests.html#a0bd9e3f3f7857cd59dd4787f27053ed2">utest_legendre</a> = res
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="keyword">  END FUNCTION utest_legendre</span>
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="comment">! ---------------------------------------------------------------------------------------!     </span>
<a name="l00157"></a>00157 
<a name="l00162"></a><a class="code" href="namespacef3dex__utests.html#a57da44b855f549d74b66e6f5766ad969">00162</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#a57da44b855f549d74b66e6f5766ad969">utest_legendre_angmatrices</a>(nside, nlmax, prec)
<a name="l00163"></a>00163   
<a name="l00164"></a>00164   <span class="keywordtype">INTEGER(I4B)</span> :: l, nlmax, nside, prec, p, npix, status
<a name="l00165"></a>00165   <span class="keywordtype">CHARACTER(LEN=*)</span>, <span class="keywordtype">PARAMETER</span> :: code = <span class="stringliteral">&#39;utest_legendre_angmatrices&#39;</span>
<a name="l00166"></a>00166   <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: Pl1, Pl2, Pltemp, ang_map
<a name="l00167"></a>00167   <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(:,:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: Plcomp 
<a name="l00168"></a>00168   <span class="keywordtype">LOGICAL</span> :: res
<a name="l00169"></a>00169   
<a name="l00170"></a>00170   npix = 12*nside**2
<a name="l00171"></a>00171   
<a name="l00172"></a>00172   <span class="keyword">ALLOCATE</span>(ang_map(0:npix-1,0:npix-1),stat = status)
<a name="l00173"></a>00173   CALL assert_alloc(status,code,<span class="stringliteral">&#39;ang_map&#39;</span>)
<a name="l00174"></a>00174   <span class="keyword">ALLOCATE</span>(Pl1(0:npix-1,0:npix-1),stat = status)
<a name="l00175"></a>00175   CALL assert_alloc(status,code,<span class="stringliteral">&#39;Pl1&#39;</span>)
<a name="l00176"></a>00176   <span class="keyword">ALLOCATE</span>(Pl2(0:npix-1,0:npix-1),stat = status)
<a name="l00177"></a>00177   CALL assert_alloc(status,code,<span class="stringliteral">&#39;Pl2&#39;</span>)
<a name="l00178"></a>00178   <span class="keyword">ALLOCATE</span>(Pltemp(0:npix-1,0:npix-1),stat = status)
<a name="l00179"></a>00179   CALL assert_alloc(status,code,<span class="stringliteral">&#39;Pltemp&#39;</span>)
<a name="l00180"></a>00180   <span class="keyword">ALLOCATE</span>(Plcomp(0:npix-1,0:npix-1,0:nlmax),stat = status)
<a name="l00181"></a>00181   CALL assert_alloc(status,code,<span class="stringliteral">&#39;Plcomp&#39;</span>)
<a name="l00182"></a>00182     
<a name="l00183"></a>00183   CALL <a class="code" href="namespacef3dex__stats.html#ac34a6421249816395b51048aa0a3dde3">gen_angles_map</a>(npix, ang_map, nside)
<a name="l00184"></a>00184      
<a name="l00185"></a>00185   <span class="keyword">DO</span> p=0, npix-1
<a name="l00186"></a>00186      CALL <a class="code" href="namespacef3dex__stats.html#aa2fb45e013179295e3b876ced9eff015">legendre_mat</a>(ang_map(p,0:npix-1),Plcomp(p,0:npix-1,0:nlmax),npix,nlmax)
<a name="l00187"></a>00187   <span class="keyword">ENDDO</span>
<a name="l00188"></a>00188   
<a name="l00189"></a>00189   res=.TRUE.
<a name="l00190"></a>00190   <span class="keyword">DO</span> l=0, nlmax
<a name="l00191"></a>00191      <span class="keyword">IF</span>( l .EQ. 0 )<span class="keyword">THEN</span>
<a name="l00192"></a>00192         Pl2 = 1.0
<a name="l00193"></a>00193      <span class="keyword">ELSE</span> <span class="keyword">IF</span>( l .EQ. 1 ) <span class="keyword">THEN</span>
<a name="l00194"></a>00194         Pl1 = 1.0
<a name="l00195"></a>00195         Pl2 = ang_map
<a name="l00196"></a>00196      <span class="keyword">ELSE</span>
<a name="l00197"></a>00197         PLtemp = Pl2
<a name="l00198"></a>00198         Pl2 = ( (2.0*<span class="keywordtype">REAL</span>(l)-1.0) * ang_map*Pl2 - <span class="keywordtype">REAL(l-1)</span> * Pl1 ) / <span class="keywordtype">REAL</span>(l)
<a name="l00199"></a>00199         Pl1 = Pltemp
<a name="l00200"></a>00200     <span class="keyword">END IF</span>
<a name="l00201"></a>00201     res = res .AND. <a class="code" href="namespacef3dex__utils.html#a234414d8daaf5e3bfd03754331b467ed">assert_DPARR</a>( Plcomp(0:npix-1,0:npix-1,l),Pl2(0:npix-1,0:npix-1), nlmax, prec)
<a name="l00202"></a>00202  <span class="keyword">ENDDO</span>
<a name="l00203"></a>00203   
<a name="l00204"></a>00204   <span class="keyword">DEALLOCATE</span>(Pl1, Pl2, Pltemp, ang_map)
<a name="l00205"></a>00205   <a class="code" href="namespacef3dex__utests.html#a57da44b855f549d74b66e6f5766ad969">utest_legendre_angmatrices</a> = res
<a name="l00206"></a>00206   RETURN
<a name="l00207"></a>00207   
<a name="l00208"></a>00208 <span class="keyword">  END FUNCTION utest_legendre_angmatrices</span>
<a name="l00209"></a>00209    
<a name="l00210"></a>00210   <span class="comment">! ---------------------------------------------------------------------------------------!     </span>
<a name="l00211"></a>00211   
<a name="l00215"></a><a class="code" href="namespacef3dex__utests.html#a711e4fe7b4894dfb823cfaede48d377d">00215</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#a711e4fe7b4894dfb823cfaede48d377d">utest_bilini_form_par</a>( ndim, prec )
<a name="l00216"></a>00216   
<a name="l00217"></a>00217     <span class="keywordtype">INTEGER(I4B)</span> :: ndim, i, j, prec
<a name="l00218"></a>00218     <span class="keywordtype">REAL(DP)</span>,<span class="keywordtype">DIMENSION(0:ndim-1,0:ndim-1)</span> :: M
<a name="l00219"></a>00219     <span class="keywordtype">REAL(DP)</span>,<span class="keywordtype">DIMENSION(0:ndim-1)</span> :: x, y
<a name="l00220"></a>00220     <span class="keywordtype">REAL(DP)</span> :: res1, res2
<a name="l00221"></a>00221     <span class="keywordtype">INTEGER</span>,<span class="keywordtype">PARAMETER</span> :: seed = 86456
<a name="l00222"></a>00222     <span class="keywordtype">REAL*8</span> :: tas, tae, tbs, tbe
<a name="l00223"></a>00223           
<a name="l00224"></a>00224     CALL srand(seed)
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="keyword">DO</span> i=0,ndim-1
<a name="l00227"></a>00227        x(i) = rand()
<a name="l00228"></a>00228        y(i) = rand()
<a name="l00229"></a>00229        <span class="keyword">DO</span> j=0, ndim-1
<a name="l00230"></a>00230           M(i,j) = rand()
<a name="l00231"></a>00231        <span class="keyword">ENDDO</span>
<a name="l00232"></a>00232     <span class="keyword">ENDDO</span>
<a name="l00233"></a>00233     
<a name="l00234"></a>00234     tas = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00235"></a>00235     res1 = <a class="code" href="namespacef3dex__stats.html#af0a10f88c8029206196ea18b3ad579ba">BILIN_FORM_PAR</a>( x(0:ndim-1), M(0:ndim-1,0:ndim-1), &amp;
<a name="l00236"></a>00236         &amp; y(0:ndim-1), 0, ndim-1 )
<a name="l00237"></a>00237     tae = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00238"></a>00238     
<a name="l00239"></a>00239     tbs = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00240"></a>00240     res2 = DOT_PRODUCT( x, MATMUL( M, y ) )
<a name="l00241"></a>00241     tbe = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00242"></a>00242     
<a name="l00243"></a>00243     <span class="comment">!PRINT*,&quot;NATIVE METHOD   :&quot;,tbe-tbs,&quot;ms&quot;</span>
<a name="l00244"></a>00244     <span class="comment">!PRINT*,&quot;PARALLEL METHOD :&quot;,tae-tas,&quot;ms&quot;</span>
<a name="l00245"></a>00245     
<a name="l00246"></a>00246     <span class="keyword">IF</span>( <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( res1, res2 , prec ) .EQV. .FALSE.)<span class="keyword">THEN</span>
<a name="l00247"></a>00247      PRINT*,<span class="stringliteral">&quot;ERROR : &quot;</span>, res1,<span class="stringliteral">&quot;!=&quot;</span>, res2   
<a name="l00248"></a>00248     <span class="keyword">ENDIF</span>
<a name="l00249"></a>00249         
<a name="l00250"></a>00250     <a class="code" href="namespacef3dex__utests.html#a711e4fe7b4894dfb823cfaede48d377d">utest_bilini_form_par</a> = <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( res1, res2, prec )
<a name="l00251"></a>00251     RETURN
<a name="l00252"></a>00252   
<a name="l00253"></a>00253 <span class="keyword">  END FUNCTION utest_bilini_form_par</span>
<a name="l00254"></a>00254       
<a name="l00255"></a>00255   <span class="comment">! ---------------------------------------------------------------------------------------!     </span>
<a name="l00256"></a>00256   
<a name="l00260"></a><a class="code" href="namespacef3dex__utests.html#af92f9fe6f9ec9dade31e9fc47ea73551">00260</a>   <span class="keyword">LOGICAL </span><span class="keyword">FUNCTION </span><a class="code" href="namespacef3dex__utests.html#af92f9fe6f9ec9dade31e9fc47ea73551">utest_matmul_par</a>( s, d1, d2, d3, prec )
<a name="l00261"></a>00261   
<a name="l00262"></a>00262     <span class="keywordtype">INTEGER(I4B)</span> :: s, d1, d2, d3, i, j, k, prec
<a name="l00263"></a>00263     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(s:d1,s:d2)</span> :: A
<a name="l00264"></a>00264     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(s:d2,s:d3)</span> :: B
<a name="l00265"></a>00265     <span class="keywordtype">REAL(DP)</span>, <span class="keywordtype">DIMENSION(s:d1,s:d3)</span> :: C, D
<a name="l00266"></a>00266     <span class="keywordtype">INTEGER</span>,<span class="keywordtype">PARAMETER</span> :: seed = 86456
<a name="l00267"></a>00267     <span class="keywordtype">LOGICAL</span> :: res   
<a name="l00268"></a>00268     <span class="keywordtype">REAL*8</span> :: tas, tae, tbs, tbe
<a name="l00269"></a>00269     
<a name="l00270"></a>00270     CALL srand(seed)
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <span class="keyword">DO</span> i=s,d1
<a name="l00273"></a>00273        <span class="keyword">DO</span> j=s, d2
<a name="l00274"></a>00274           <span class="keyword">DO</span> k= s, d3
<a name="l00275"></a>00275              A(i,j) = rand()
<a name="l00276"></a>00276              B(j,k) = rand()
<a name="l00277"></a>00277           <span class="keyword">ENDDO</span>
<a name="l00278"></a>00278        <span class="keyword">ENDDO</span>
<a name="l00279"></a>00279     <span class="keyword">ENDDO</span>
<a name="l00280"></a>00280     
<a name="l00281"></a>00281     tas = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00282"></a>00282     CALL <a class="code" href="namespacef3dex__stats.html#a046613d05a3a2eb1808a7ee99fba7509">MATMUL_PAR</a>( A(s:d1,s:d2), B(s:d2,s:d3), C(s:d1,s:d3), &amp;
<a name="l00283"></a>00283          &amp; s, d1, d2, d3 )
<a name="l00284"></a>00284     tae = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00285"></a>00285     
<a name="l00286"></a>00286     tbs = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00287"></a>00287     D = MATMUL( A, B ) 
<a name="l00288"></a>00288     tbe = <a class="code" href="namespacef3dex__utils.html#ac5aa172010ec6cd9bd4c5273904b0405">wtime</a>()
<a name="l00289"></a>00289     
<a name="l00290"></a>00290     <span class="keyword">DO</span> i=s, d1
<a name="l00291"></a>00291      <span class="keyword">DO</span> k=s,d3
<a name="l00292"></a>00292         <span class="keyword">IF</span>( <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( C(i,k) , D(i,k) , prec ) .EQV. .FALSE.)<span class="keyword">THEN</span>
<a name="l00293"></a>00293            PRINT*,<span class="stringliteral">&quot;ERROR : &quot;</span>, C(i,k), <span class="stringliteral">&quot;!=&quot;</span> , D(i,k)     
<a name="l00294"></a>00294         <span class="keyword">ENDIF</span>
<a name="l00295"></a>00295         res = res .AND.  <a class="code" href="namespacef3dex__utils.html#ad4cb6613ee589637f453ef808466a0f9">assert_DP</a>( C(i,k) , D(i,k) , prec )
<a name="l00296"></a>00296      <span class="keyword">ENDDO</span>
<a name="l00297"></a>00297     <span class="keyword">ENDDO</span>
<a name="l00298"></a>00298     
<a name="l00299"></a>00299     <span class="comment">!PRINT*,&quot;&gt; NATIVE METHOD   :&quot;,tbe-tbs,&quot;s&quot;</span>
<a name="l00300"></a>00300     <span class="comment">!PRINT*,&quot;&gt; PARALLEL METHOD :&quot;,tae-tas,&quot;s&quot;</span>
<a name="l00301"></a>00301     
<a name="l00302"></a>00302     <a class="code" href="namespacef3dex__utests.html#af92f9fe6f9ec9dade31e9fc47ea73551">utest_matmul_par</a> = res
<a name="l00303"></a>00303     RETURN
<a name="l00304"></a>00304   
<a name="l00305"></a>00305 <span class="keyword">  END FUNCTION utest_matmul_par</span>
<a name="l00306"></a>00306       
<a name="l00307"></a>00307   <span class="comment">! ---------------------------------------------------------------------------------------!     </span>
<a name="l00308"></a>00308   
<a name="l00309"></a>00309      
<a name="l00310"></a>00310 <span class="keyword">END MODULE f3dex_utests</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 16 2011 01:39:45 for 3DEX by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
